<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Malleable Cover Generator</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    
    html, body {
      height: 100%;
      overflow: hidden;
    }
    
    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
      background: #111;
      color: #fff;
    }
    
    /* ============================================
       MAIN LAYOUT
       ============================================ */
    
    .app {
      height: 100%;
      display: flex;
      flex-direction: column;
    }
    
    /* Header */
    .header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 12px 16px;
      background: #1a1a1a;
      border-bottom: 1px solid #333;
      flex-shrink: 0;
    }
    
    .header h1 {
      font-size: 0.875rem;
      font-weight: 600;
    }
    
    .screenshot-btn {
      padding: 8px 16px;
      background: #0C6C9C;
      border: none;
      border-radius: 6px;
      color: #fff;
      font-family: inherit;
      font-size: 0.8125rem;
      font-weight: 600;
      cursor: pointer;
    }
    
    .screenshot-btn:active {
      background: #0a5a82;
    }
    
    /* Main area */
    .main {
      flex: 1;
      display: flex;
      overflow: hidden;
    }
    
    /* Preview area */
    .preview-area {
      flex: 1;
      display: flex;
      align-items: center;
      justify-content: center;
      background: #0a0a0a;
      padding: 16px;
      overflow: hidden;
    }
    
    /* Controls panel */
    .controls-panel {
      width: 280px;
      background: #1a1a1a;
      border-left: 1px solid #333;
      overflow-y: auto;
      flex-shrink: 0;
    }
    
    /* Mobile: controls below */
    @media (max-width: 700px) {
      .main {
        flex-direction: column;
      }
      
      .preview-area {
        flex: none;
        height: 55%;
        padding: 12px;
      }
      
      .controls-panel {
        width: 100%;
        flex: 1;
        border-left: none;
        border-top: 1px solid #333;
      }
    }
    
    /* ============================================
       PREVIEW
       ============================================ */
    
    .preview-container {
      position: relative;
      width: 100%;
      height: 100%;
      max-width: 270px;
      max-height: 480px;
      aspect-ratio: 9 / 16;
    }
    
    @media (min-width: 700px) {
      .preview-container {
        max-width: 320px;
        max-height: 568px;
      }
    }
    
    .preview {
      position: relative;
      width: 100%;
      height: 100%;
      background: #000;
      overflow: hidden;
    }
    
    /* Frame */
    .preview-frame {
      position: absolute;
      inset: 0;
      border-style: solid;
      border-color: var(--frame-colour, #0E394F);
      border-width: var(--frame-width, 12px);
      pointer-events: none;
      z-index: 10;
    }
    
    /* Media */
    .preview-media {
      position: absolute;
      top: var(--frame-width, 12px);
      left: var(--frame-width, 12px);
      right: var(--frame-width, 12px);
      bottom: var(--frame-width, 12px);
      overflow: hidden;
      background: #1a1a1a;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .preview-media img,
    .preview-media video {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
    
    .preview-placeholder {
      color: #444;
      font-size: 0.75rem;
      text-align: center;
      padding: 20px;
    }
    
    /* Overlay */
    .preview-overlay {
      position: absolute;
      top: var(--frame-width, 12px);
      left: var(--frame-width, 12px);
      right: var(--frame-width, 12px);
      bottom: var(--frame-width, 12px);
      display: flex;
      flex-direction: column;
      z-index: 20;
      pointer-events: none;
    }
    
    /* Logo */
    .preview-logo {
      padding: var(--logo-padding, 16px) 12px 8px;
      text-align: var(--logo-align, center);
    }
    
    .preview-logo img {
      height: var(--logo-size, 28px);
      width: auto;
      max-width: 85%;
      filter: drop-shadow(0 1px 3px rgba(0,0,0,0.5));
    }
    
    .preview-logo .placeholder-logo {
      font-size: var(--logo-size, 28px);
      font-weight: 700;
      color: #fff;
      text-shadow: 0 2px 4px rgba(0,0,0,0.5);
      letter-spacing: 0.12em;
      line-height: 1;
    }
    
    /* Spacer */
    .preview-spacer {
      flex: 1;
    }
    
    /* Articles */
    .preview-articles {
      padding: var(--articles-padding, 12px);
      background: linear-gradient(to top, rgba(0,0,0,0.75) 0%, rgba(0,0,0,0) 100%);
    }
    
    .preview-article {
      font-size: var(--articles-size, 10px);
      font-weight: 600;
      color: #fff;
      text-transform: uppercase;
      letter-spacing: 0.03em;
      margin-bottom: 6px;
      text-shadow: 0 1px 2px rgba(0,0,0,0.6);
    }
    
    .preview-article:last-child {
      margin-bottom: 0;
    }
    
    /* Meta */
    .preview-meta {
      display: flex;
      justify-content: space-between;
      padding: 8px var(--articles-padding, 12px);
      font-size: calc(var(--articles-size, 10px) * 0.8);
      color: rgba(255,255,255,0.8);
      background: rgba(0,0,0,0.6);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }
    
    /* ============================================
       CONTROLS
       ============================================ */
    
    .control-section {
      border-bottom: 1px solid #282828;
    }
    
    .control-section-header {
      padding: 12px 16px;
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: #666;
      background: #151515;
      cursor: pointer;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }
    
    .control-section-header::after {
      content: 'â–¼';
      font-size: 0.5rem;
      transition: transform 0.2s;
    }
    
    .control-section.collapsed .control-section-header::after {
      transform: rotate(-90deg);
    }
    
    .control-section.collapsed .control-section-body {
      display: none;
    }
    
    .control-section-body {
      padding: 12px 16px;
    }
    
    /* Control row */
    .control-row {
      margin-bottom: 12px;
    }
    
    .control-row:last-child {
      margin-bottom: 0;
    }
    
    .control-label {
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 0.75rem;
      color: #999;
      margin-bottom: 6px;
    }
    
    .control-value {
      font-family: monospace;
      color: #666;
    }
    
    /* Slider */
    .control-slider {
      width: 100%;
      height: 6px;
      -webkit-appearance: none;
      appearance: none;
      background: #333;
      border-radius: 3px;
      outline: none;
    }
    
    .control-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 16px;
      height: 16px;
      background: #0C6C9C;
      border-radius: 50%;
      cursor: pointer;
    }
    
    .control-slider::-moz-range-thumb {
      width: 16px;
      height: 16px;
      background: #0C6C9C;
      border-radius: 50%;
      cursor: pointer;
      border: none;
    }
    
    /* Select */
    .control-select {
      width: 100%;
      padding: 8px 10px;
      background: #2a2a2a;
      border: 1px solid #333;
      border-radius: 4px;
      color: #fff;
      font-family: inherit;
      font-size: 0.8125rem;
    }
    
    /* Text input */
    .control-input {
      width: 100%;
      padding: 8px 10px;
      background: #2a2a2a;
      border: 1px solid #333;
      border-radius: 4px;
      color: #fff;
      font-family: inherit;
      font-size: 0.8125rem;
    }
    
    .control-input:focus {
      outline: none;
      border-color: #0C6C9C;
    }
    
    /* File input */
    .file-input-wrap {
      position: relative;
    }
    
    .file-input-wrap input[type="file"] {
      position: absolute;
      inset: 0;
      opacity: 0;
      cursor: pointer;
    }
    
    .file-input-btn {
      display: block;
      width: 100%;
      padding: 10px;
      background: #2a2a2a;
      border: 1px dashed #444;
      border-radius: 4px;
      color: #888;
      font-size: 0.75rem;
      text-align: center;
    }
    
    .file-input-btn.has-file {
      border-style: solid;
      border-color: #0C6C9C;
      color: #fff;
    }
    
    /* Colour presets */
    .colour-row {
      display: flex;
      gap: 6px;
      align-items: center;
    }
    
    .colour-input {
      width: 36px;
      height: 36px;
      padding: 0;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      flex-shrink: 0;
    }
    
    .colour-presets {
      display: flex;
      gap: 4px;
      flex-wrap: wrap;
    }
    
    .colour-preset {
      width: 28px;
      height: 28px;
      border-radius: 4px;
      border: 2px solid transparent;
      cursor: pointer;
    }
    
    .colour-preset.active {
      border-color: #fff;
    }
    
    /* Logo buttons */
    .logo-buttons {
      display: flex;
      gap: 6px;
      margin-bottom: 8px;
    }
    
    .logo-btn {
      flex: 1;
      padding: 8px;
      background: #2a2a2a;
      border: 2px solid #333;
      border-radius: 4px;
      cursor: pointer;
      text-align: center;
    }
    
    .logo-btn.active {
      border-color: #0C6C9C;
    }
    
    .logo-btn-preview {
      font-size: 0.5rem;
      font-weight: 700;
      letter-spacing: 0.1em;
      padding: 3px 6px;
      border-radius: 2px;
      display: inline-block;
      margin-bottom: 2px;
    }
    
    .logo-btn-preview.dark {
      background: #1a1a1a;
      color: #fff;
    }
    
    .logo-btn-preview.light {
      background: #e0e0e0;
      color: #1a1a1a;
    }
    
    .logo-btn-label {
      font-size: 0.625rem;
      color: #888;
    }
    
    /* Articles inputs */
    .articles-inputs {
      display: flex;
      flex-direction: column;
      gap: 6px;
    }
    
    /* ============================================
       FULLSCREEN MODE
       ============================================ */
    
    .app.fullscreen {
      position: fixed;
      inset: 0;
      z-index: 9999;
      background: #000;
    }
    
    .app.fullscreen .header,
    .app.fullscreen .controls-panel {
      display: none;
    }
    
    .app.fullscreen .preview-area {
      padding: 0;
    }
    
    .app.fullscreen .preview-container {
      max-width: none;
      max-height: none;
      width: 100%;
      height: 100%;
    }
    
    .app.fullscreen .preview {
      border-radius: 0;
    }
    
    /* Exit fullscreen hint */
    .fullscreen-hint {
      display: none;
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      padding: 8px 16px;
      background: rgba(0,0,0,0.8);
      border-radius: 20px;
      font-size: 0.75rem;
      color: #888;
      z-index: 10000;
      animation: fadeOut 3s forwards;
      animation-delay: 2s;
    }
    
    .app.fullscreen .fullscreen-hint {
      display: block;
    }
    
    @keyframes fadeOut {
      to { opacity: 0; }
    }
  </style>
</head>
<body>
  <div class="app" id="app">
    
    <header class="header">
      <h1>Cover Generator</h1>
      <button class="screenshot-btn" onclick="enterFullscreen()">Screenshot Mode</button>
    </header>
    
    <main class="main">
      <section class="preview-area">
        <div class="preview-container">
          <div class="preview" id="preview">
            <div class="preview-frame" id="frame"></div>
            <div class="preview-media" id="media-container">
              <div class="preview-placeholder" id="placeholder">
                Tap "Media" to add cover
              </div>
              <img id="preview-image" src="" alt="" style="display: none;">
              <video id="preview-video" src="" muted loop playsinline style="display: none;"></video>
            </div>
            <div class="preview-overlay">
              <div class="preview-logo" id="logo-container">
                <img id="logo-img" src="" alt="MALLEABLE" style="display: none;">
                <span class="placeholder-logo" id="logo-placeholder">MALLEABLE</span>
              </div>
              <div class="preview-spacer"></div>
              <div class="preview-articles" id="articles-container">
                <div class="preview-article">Made: Emmaus Cross</div>
                <div class="preview-article">Found: Structural Colour</div>
                <div class="preview-article">Thinking: The Malleable Mind</div>
              </div>
              <div class="preview-meta">
                <span id="meta-edition">Edition 01</span>
                <span id="meta-date">February 2026</span>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <aside class="controls-panel">
        
        <!-- MEDIA -->
        <div class="control-section">
          <div class="control-section-header">Media</div>
          <div class="control-section-body">
            <div class="control-row">
              <div class="file-input-wrap">
                <input type="file" id="media-input" accept="image/*,video/*">
                <div class="file-input-btn" id="media-btn">Choose image or video</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- LOGO -->
        <div class="control-section">
          <div class="control-section-header">Logo</div>
          <div class="control-section-body">
            <div class="control-row">
              <div class="logo-buttons">
                <div class="logo-btn active" data-logo="white" onclick="selectLogo('white')">
                  <span class="logo-btn-preview dark">MAL</span>
                  <div class="logo-btn-label">White</div>
                </div>
                <div class="logo-btn" data-logo="black" onclick="selectLogo('black')">
                  <span class="logo-btn-preview light">MAL</span>
                  <div class="logo-btn-label">Black</div>
                </div>
              </div>
            </div>
            <div class="control-row">
              <div class="file-input-wrap">
                <input type="file" id="logo-input" accept="image/png">
                <div class="file-input-btn" id="logo-btn">Or upload custom PNG</div>
              </div>
            </div>
            <div class="control-row">
              <div class="control-label">
                <span>Size</span>
                <span class="control-value" id="logo-size-value">28px</span>
              </div>
              <input type="range" class="control-slider" id="logo-size" min="16" max="48" value="28" oninput="updateLogoSize(this.value)">
            </div>
            <div class="control-row">
              <div class="control-label">Alignment</div>
              <select class="control-select" id="logo-align" onchange="updateLogoAlign(this.value)">
                <option value="center" selected>Centre</option>
                <option value="left">Left</option>
                <option value="right">Right</option>
              </select>
            </div>
          </div>
        </div>
        
        <!-- FRAME -->
        <div class="control-section">
          <div class="control-section-header">Frame</div>
          <div class="control-section-body">
            <div class="control-row">
              <div class="control-label">Colour</div>
              <div class="colour-row">
                <input type="color" class="colour-input" id="colour-input" value="#0E394F" oninput="setColour(this.value)">
                <div class="colour-presets" id="presets">
                  <div class="colour-preset active" style="background: #0E394F;" data-colour="#0E394F" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #0C6C9C;" data-colour="#0C6C9C" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #2C77EE;" data-colour="#2C77EE" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #8E9F3A;" data-colour="#8E9F3A" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #9C1C29;" data-colour="#9C1C29" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #BC6C67;" data-colour="#BC6C67" onclick="setColourPreset(this)"></div>
                  <div class="colour-preset" style="background: #212121;" data-colour="#212121" onclick="setColourPreset(this)"></div>
                </div>
              </div>
            </div>
            <div class="control-row">
              <div class="control-label">
                <span>Thickness</span>
                <span class="control-value" id="frame-width-value">12px</span>
              </div>
              <input type="range" class="control-slider" id="frame-width" min="6" max="24" value="12" oninput="updateFrameWidth(this.value)">
            </div>
          </div>
        </div>
        
        <!-- ARTICLES -->
        <div class="control-section">
          <div class="control-section-header">Articles</div>
          <div class="control-section-body">
            <div class="control-row">
              <div class="articles-inputs">
                <input type="text" class="control-input article-input" value="Made: Emmaus Cross" oninput="updateArticles()">
                <input type="text" class="control-input article-input" value="Found: Structural Colour" oninput="updateArticles()">
                <input type="text" class="control-input article-input" value="Thinking: The Malleable Mind" oninput="updateArticles()">
              </div>
            </div>
            <div class="control-row">
              <div class="control-label">
                <span>Text size</span>
                <span class="control-value" id="articles-size-value">10px</span>
              </div>
              <input type="range" class="control-slider" id="articles-size" min="7" max="16" value="10" oninput="updateArticlesSize(this.value)">
            </div>
          </div>
        </div>
        
        <!-- EDITION -->
        <div class="control-section">
          <div class="control-section-header">Edition</div>
          <div class="control-section-body">
            <div class="control-row">
              <div class="control-label">Number</div>
              <input type="text" class="control-input" id="edition-input" value="Edition 01" oninput="updateMeta()">
            </div>
            <div class="control-row">
              <div class="control-label">Date</div>
              <input type="text" class="control-input" id="date-input" value="February 2026" oninput="updateMeta()">
            </div>
          </div>
        </div>
        
      </aside>
    </main>
    
    <div class="fullscreen-hint">Tap anywhere to exit, then screenshot</div>
    
  </div>

  <script>
    // ============================================
    // ELEMENTS
    // ============================================
    
    const app = document.getElementById('app');
    const preview = document.getElementById('preview');
    const frame = document.getElementById('frame');
    const mediaContainer = document.getElementById('media-container');
    const placeholder = document.getElementById('placeholder');
    const previewImage = document.getElementById('preview-image');
    const previewVideo = document.getElementById('preview-video');
    const logoContainer = document.getElementById('logo-container');
    const logoImg = document.getElementById('logo-img');
    const logoPlaceholder = document.getElementById('logo-placeholder');
    const articlesContainer = document.getElementById('articles-container');
    
    // Logo paths
    const logoWhitePath = '../template/MALLEABLE-Logo-wh.png';
    const logoBlackPath = '../template/MALLEABLE-Logo-bl.png';
    
    // ============================================
    // MEDIA
    // ============================================
    
    document.getElementById('media-input').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      const url = URL.createObjectURL(file);
      placeholder.style.display = 'none';
      
      if (file.type.startsWith('video/')) {
        previewImage.style.display = 'none';
        previewVideo.style.display = 'block';
        previewVideo.src = url;
        previewVideo.play();
      } else {
        previewVideo.style.display = 'none';
        previewImage.style.display = 'block';
        previewImage.src = url;
      }
      
      document.getElementById('media-btn').textContent = file.name;
      document.getElementById('media-btn').classList.add('has-file');
    });
    
    // ============================================
    // LOGO
    // ============================================
    
    function selectLogo(type) {
      // Update buttons
      document.querySelectorAll('.logo-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.logo === type);
      });
      
      // Load logo
      const path = type === 'white' ? logoWhitePath : logoBlackPath;
      logoImg.src = path;
      logoImg.style.display = 'block';
      logoPlaceholder.style.display = 'none';
      
      // Reset custom upload
      document.getElementById('logo-btn').textContent = 'Or upload custom PNG';
      document.getElementById('logo-btn').classList.remove('has-file');
    }
    
    document.getElementById('logo-input').addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      
      logoImg.src = URL.createObjectURL(file);
      logoImg.style.display = 'block';
      logoPlaceholder.style.display = 'none';
      
      document.getElementById('logo-btn').textContent = file.name;
      document.getElementById('logo-btn').classList.add('has-file');
      
      // Clear button selection
      document.querySelectorAll('.logo-btn').forEach(btn => btn.classList.remove('active'));
    });
    
    function updateLogoSize(value) {
      document.documentElement.style.setProperty('--logo-size', value + 'px');
      document.getElementById('logo-size-value').textContent = value + 'px';
    }
    
    function updateLogoAlign(value) {
      document.documentElement.style.setProperty('--logo-align', value);
    }
    
    // ============================================
    // FRAME
    // ============================================
    
    function setColour(colour) {
      document.documentElement.style.setProperty('--frame-colour', colour);
      document.getElementById('colour-input').value = colour;
    }
    
    function setColourPreset(el) {
      const colour = el.dataset.colour;
      setColour(colour);
      
      document.querySelectorAll('.colour-preset').forEach(p => p.classList.remove('active'));
      el.classList.add('active');
    }
    
    function updateFrameWidth(value) {
      document.documentElement.style.setProperty('--frame-width', value + 'px');
      document.getElementById('frame-width-value').textContent = value + 'px';
    }
    
    // ============================================
    // ARTICLES
    // ============================================
    
    function updateArticles() {
      const inputs = document.querySelectorAll('.article-input');
      articlesContainer.innerHTML = '';
      
      inputs.forEach(input => {
        if (input.value.trim()) {
          const div = document.createElement('div');
          div.className = 'preview-article';
          div.textContent = input.value;
          articlesContainer.appendChild(div);
        }
      });
    }
    
    function updateArticlesSize(value) {
      document.documentElement.style.setProperty('--articles-size', value + 'px');
      document.getElementById('articles-size-value').textContent = value + 'px';
    }
    
    // ============================================
    // EDITION
    // ============================================
    
    function updateMeta() {
      document.getElementById('meta-edition').textContent = document.getElementById('edition-input').value || 'Edition';
      document.getElementById('meta-date').textContent = document.getElementById('date-input').value || 'Date';
    }
    
    // ============================================
    // FULLSCREEN
    // ============================================
    
    function enterFullscreen() {
      app.classList.add('fullscreen');
      
      // Try native fullscreen
      if (document.documentElement.requestFullscreen) {
        document.documentElement.requestFullscreen().catch(() => {});
      } else if (document.documentElement.webkitRequestFullscreen) {
        document.documentElement.webkitRequestFullscreen();
      }
    }
    
    function exitFullscreen() {
      app.classList.remove('fullscreen');
      
      if (document.exitFullscreen) {
        document.exitFullscreen().catch(() => {});
      } else if (document.webkitExitFullscreen) {
        document.webkitExitFullscreen();
      }
    }
    
    // Exit on tap in fullscreen
    app.addEventListener('click', (e) => {
      if (app.classList.contains('fullscreen')) {
        exitFullscreen();
      }
    });
    
    // Exit on escape
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape' && app.classList.contains('fullscreen')) {
        exitFullscreen();
      }
    });
    
    // Handle native fullscreen exit
    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement) {
        app.classList.remove('fullscreen');
      }
    });
    
    // ============================================
    // COLLAPSIBLE SECTIONS
    // ============================================
    
    document.querySelectorAll('.control-section-header').forEach(header => {
      header.addEventListener('click', () => {
        header.parentElement.classList.toggle('collapsed');
      });
    });
    
    // ============================================
    // INIT
    // ============================================
    
    setColour('#0E394F');
    updateFrameWidth(12);
    updateLogoSize(28);
    updateArticlesSize(10);
    selectLogo('white');
  </script>
</body>
</html>
